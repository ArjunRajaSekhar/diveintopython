
<!DOCTYPE html>
<!--[if IE 9]><html class="lt-ie10" lang="en" > <![endif]-->
<html class="no-js" lang="en" >
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>5.4.Â Instantiating Classes</title>
        <link rev="made" href="josh@servercobra.com" />
        <meta name="generator" content="convert_to_jinja2.py" />
        <meta name="keywords" content="Python, Dive Into Python, tutorial, object-oriented, programming, documentation, book, free" />
        <meta name="description" content="Python from novice to pro" />
        <link rel="home" href="http://www.diveintopython.net/" title="Dive Into Python" />
        
        <link rel="up" href="index.html" title=" Chapter5.Objects and Object-Orientation" />
        
        
        
        <link rel="next" href="userdict.html" title=" 5.5.Exploring UserDict: A Wrapper Class" />
        
         <link rel="stylesheet" href="../css/normalize.css">
         <link rel="stylesheet" href="../css/foundation.css">
         <link rel="stylesheet" href="../css/diveintopython.css" type="text/css" />


         <script src="../js/modernizr.js"></script>
    </head>
    <body>
        <div class="row">
            <div class="small-12 columns" id="Header">
                <div class="row">
                    <div class="small-11 columns">
                        
                        <td align="left" colspan="5" id="breadcrumb" valign="top">You are here: <a href="../index.html">Home</a>&#160;&gt;&#160;<a href="../toc/index.html">Dive Into Python</a>&#160;&gt;&#160;<a href="index.html">Objects and Object-Orientation</a>&#160;&gt;&#160;<span class="thispage">Instantiating Classes</span></td>
                        
                    </div>
                    <div class="small-1 columns">
                        
                        <td align="right" id="navigation" valign="top">&#160;&#160;&#160;<a href="defining_classes.html" title="Prev: &#8220;Defining Classes&#8221;">&lt;&lt;</a>&#160;&#160;&#160;<a href="userdict.html" title="Next: &#8220;Exploring UserDict: A Wrapper Class&#8221;">&gt;&gt;</a></td>
                        
                    </div>
                </div>


                <div id="logocontainer">
                    <h1 id="logo"><a href="http://www.diveintopython.net/index.html" accesskey="1">Dive Into Python</a></h1>
                    <p id="tagline">Python from novice to pro</p>
                    <a href="http://www.amazon.com/gp/product/B001GIOFN8/ref=as_li_tf_tl?ie=UTF8&tag=diveintopython-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=B001GIOFN8"><img src="../images/amazon-buy-button.gif"></a>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        <div class="toc">
<ul>
<li><span class="section"><a href="instantiating_classes.html#d0e12165">5.4.1. Garbage Collection</a></span></li>
</ul>
</div>
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        <div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="fileinfo.create"></a>5.4.&#160;Instantiating Classes
                  </h2>
</div>
</div>
<div></div>
</div>
<div class="toc">
<ul>
<li><span class="section"><a href="instantiating_classes.html#d0e12165">5.4.1. Garbage Collection</a></span></li>
</ul>
</div>
<div class="abstract">
<p>Instantiating classes in <span class="application">Python</span> is straightforward.  To instantiate a class, simply call the class as if it were a function, passing the arguments that the
               <tt class="function">__init__</tt> method defines.  The return value will be the newly created object.
            </p>
</div>
<div class="example"><a name="d0e12003"></a><h3 class="title">Example&#160;5.7.&#160;Creating a <tt class="classname">FileInfo</tt> Instance
            </h3><pre class="screen"><tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">import</span> fileinfo</span>
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput">f = fileinfo.FileInfo(<span class="pystring">"/music/_singles/kairo.mp3"</span>)</span> <a name="fileinfo.create.1.1"></a><img alt="1" border="0" height="12" src="../images/callouts/1.png" width="12">
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput">f.__class__</span>                                        <a name="fileinfo.create.1.2"></a><img alt="2" border="0" height="12" src="../images/callouts/2.png" width="12">
<span class="computeroutput">&lt;class fileinfo.FileInfo at 010EC204&gt;</span>
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput">f.__doc__</span>                                          <a name="fileinfo.create.1.3"></a><img alt="3" border="0" height="12" src="../images/callouts/3.png" width="12">
<span class="computeroutput">'store file metadata'</span>
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput">f</span>                                                  <a name="fileinfo.create.1.4"></a><img alt="4" border="0" height="12" src="../images/callouts/4.png" width="12">
<span class="computeroutput">{'name': '/music/_singles/kairo.mp3'}</span></img></img></img></img></pre><div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="12"><a href="#fileinfo.create.1.1"><img alt="1" border="0" height="12" src="../images/callouts/1.png" width="12"/></a>
</td>
<td align="left" valign="top">You are creating an instance of the <tt class="classname">FileInfo</tt> class (defined in the <tt class="filename">fileinfo</tt> module) and assigning the newly created instance to the variable <tt class="varname">f</tt>.  You are passing one parameter, <tt class="literal">/music/_singles/kairo.mp3</tt>, which will end up as the <tt class="varname">filename</tt> argument in <tt class="classname">FileInfo</tt>'s <tt class="function">__init__</tt> method.
                     </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#fileinfo.create.1.2"><img alt="2" border="0" height="12" src="../images/callouts/2.png" width="12"/></a>
</td>
<td align="left" valign="top">Every class instance has a built-in attribute, <tt class="literal">__class__</tt>, which is the object's class.  (Note that the representation of this includes the physical address of the instance on my
                        machine; your representation will be different.)  <span class="application">Java</span> programmers may be familiar with the <tt class="classname">Class</tt> class, which contains methods like <tt class="function">getName</tt> and <tt class="function">getSuperclass</tt> to get metadata information about an object.  In <span class="application">Python</span>, this kind of metadata is available directly on the object itself through attributes like <tt class="literal">__class__</tt>, <tt class="literal">__name__</tt>, and <tt class="literal">__bases__</tt>.
                     </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#fileinfo.create.1.3"><img alt="3" border="0" height="12" src="../images/callouts/3.png" width="12"/></a>
</td>
<td align="left" valign="top">You can access the instance's <tt class="literal">doc string</tt> just as with a function or a module.  All instances of a class share the same <tt class="literal">doc string</tt>.
                     </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#fileinfo.create.1.4"><img alt="4" border="0" height="12" src="../images/callouts/4.png" width="12"/></a>
</td>
<td align="left" valign="top">Remember when the <tt class="function">__init__</tt> method <a href="defining_classes.html#fileinfo.class.example" title="Example&#160;5.4.&#160;Defining the FileInfo Class">assigned its <tt class="varname">filename</tt> argument to <tt class="literal">self["name"]</tt></a>?  Well, here's the result.  The arguments you pass when you create the class instance get sent right along to the <tt class="function">__init__</tt> method (along with the object reference, <tt class="literal">self</tt>, which <span class="application">Python</span> adds for free).
                     </td>
</tr>
</table>
</div>
</div><a name="compare.new.java"></a><table border="0" class="note" summary="">
<tr>
<td align="center" rowspan="2" valign="top" width="1%"><img alt="Note" height="24" src="../images/note.png" title="" width="24"/></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top" width="99%">In <span class="application">Python</span>, simply call a class as if it were a function to create a new instance of the class.  There is no explicit <tt class="literal">new</tt> operator like <span class="application"><span class="acronym">C++</span></span> or <span class="application">Java</span>.
               </td>
</tr>
</table>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="d0e12165"></a>5.4.1.&#160;Garbage Collection
                     </h3>
</div>
</div>
<div></div>
</div>
<p>If creating new instances is easy, destroying them is even easier.  In general, there is no need to explicitly free instances,
               because they are freed automatically when the variables assigned to them go out of scope.  Memory leaks are rare in <span class="application">Python</span>.
            </p>
<div class="example"><a name="fileinfo.scope"></a><h3 class="title">Example&#160;5.8.&#160;Trying to Implement a Memory Leak</h3><pre class="screen"><tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">def</span><span class="pyclass"> leakmem</span>():</span>
<tt class="prompt">...     </tt><span class="userinput">f = fileinfo.FileInfo(<span class="pystring">'/music/_singles/kairo.mp3'</span>)</span> <a name="fileinfo.create.2.1"></a><img alt="1" border="0" height="12" src="../images/callouts/1.png" width="12">
<tt class="prompt">...     </tt>
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">for</span> i <span class="pykeyword">in</span> range(100):</span>
<tt class="prompt">...     </tt><span class="userinput">leakmem()</span>                                          <a name="fileinfo.create.2.3"></a><img alt="2" border="0" height="12" src="../images/callouts/2.png" width="12"/></img></pre><div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="12"><a href="#fileinfo.create.2.1"><img alt="1" border="0" height="12" src="../images/callouts/1.png" width="12"/></a>
</td>
<td align="left" valign="top">Every time the <tt class="function">leakmem</tt> function is called, you are creating an instance of <tt class="classname">FileInfo</tt> and assigning it to the variable <tt class="varname">f</tt>, which is a local variable within the function.  Then the function ends without ever freeing <tt class="varname">f</tt>, so you would expect a memory leak, but you would be wrong.  When the function ends, the local variable <tt class="varname">f</tt> goes out of scope.  At this point, there are no longer any references to the newly created instance of <tt class="classname">FileInfo</tt> (since you never assigned it to anything other than <tt class="varname">f</tt>), so <span class="application">Python</span> destroys the instance for us.
                        </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#fileinfo.create.2.3"><img alt="2" border="0" height="12" src="../images/callouts/2.png" width="12"/></a>
</td>
<td align="left" valign="top">No matter how many times you call the <tt class="function">leakmem</tt> function, it will never leak memory, because every time, <span class="application">Python</span> will destroy the newly created <tt class="classname">FileInfo</tt> class before returning from <tt class="function">leakmem</tt>.
                        </td>
</tr>
</table>
</div>
</div>
<p>The technical term for this form of garbage collection is &#8220;<span class="quote">reference counting</span>&#8221;.  <span class="application">Python</span> keeps a list of references to every instance created.  In the above example, there was only one reference to the <tt class="classname">FileInfo</tt> instance: the local variable <tt class="varname">f</tt>.  When the function ends, the variable <tt class="varname">f</tt> goes out of scope, so the reference count drops to <tt class="constant">0</tt>, and <span class="application">Python</span> destroys the instance automatically.
            </p>
<p>In previous versions of <span class="application">Python</span>, there were situations where reference counting failed, and <span class="application">Python</span> couldn't clean up after you.  If you created two instances that referenced each other (for instance, a doubly-linked list,
               where each node has a pointer to the previous and next node in the list), neither instance would ever be destroyed automatically
               because <span class="application">Python</span> (correctly) believed that there is always a reference to each instance.  <span class="application">Python</span> 2.0 has an additional form of garbage collection called &#8220;<span class="quote">mark-and-sweep</span>&#8221; which is smart enough to notice this virtual gridlock and clean up circular references correctly.
            </p>
<p>As a former philosophy major, it disturbs me to think that things disappear when no one is looking at them, but that's exactly
               what happens in <span class="application">Python</span>.  In general, you can simply forget about memory management and let <span class="application">Python</span> clean up after you.
            </p>
<div class="furtherreading">
<h3>Further Reading on Garbage Collection</h3>
<ul>
<li><a href="http://www.python.org/doc/current/lib/"><i class="citetitle"><span class="application">Python</span> Library Reference</i></a> summarizes <a href="http://www.python.org/doc/current/lib/specialattrs.html">built-in attributes like <tt class="literal">__class__</tt></a>.
                  </li>
<li><a href="http://www.python.org/doc/current/lib/"><i class="citetitle"><span class="application">Python</span> Library Reference</i></a> documents the <a href="http://www.python.org/doc/current/lib/module-gc.html"><tt class="filename">gc</tt> module</a>, which gives you low-level control over <span class="application">Python</span>'s garbage collection.
                  </li>
</ul>
</div>
</div>
</div>
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        <table border="0" cellpadding="0" cellspacing="0" class="Footer" summary="" width="100%">
<tr>
<td align="left" width="35%"><br><a class="NavigationArrow" href="defining_classes.html">&lt;&lt;&#160;Defining Classes</a></br></td>
<td align="center" width="30%"><br>&#160;<span class="divider">|</span>&#160;<a href="index.html#fileinfo.divein" title="5.1.&#160;Diving In">1</a> <span class="divider">|</span> <a href="importing_modules.html" title="5.2.&#160;Importing Modules Using from module import">2</a> <span class="divider">|</span> <a href="defining_classes.html" title="5.3.&#160;Defining Classes">3</a> <span class="divider">|</span> <span class="thispage">4</span> <span class="divider">|</span> <a href="userdict.html" title="5.5.&#160;Exploring UserDict: A Wrapper Class">5</a> <span class="divider">|</span> <a href="special_class_methods.html" title="5.6.&#160;Special Class Methods">6</a> <span class="divider">|</span> <a href="special_class_methods2.html" title="5.7.&#160;Advanced Special Class Methods">7</a> <span class="divider">|</span> <a href="class_attributes.html" title="5.8.&#160;Introducing Class Attributes">8</a> <span class="divider">|</span> <a href="private_functions.html" title="5.9.&#160;Private Functions">9</a> <span class="divider">|</span> <a href="summary.html" title="5.10.&#160;Summary">10</a>&#160;<span class="divider">|</span>&#160;
            </br></td>
<td align="right" width="35%"><br><a class="NavigationArrow" href="userdict.html">Exploring UserDict: A Wrapper Class&#160;&gt;&gt;</a></br></td>
</tr>
<tr>
<td colspan="3"><br/></td>
</tr>
</table>
        <!-- Footer -->
<div class="Footer">
    <p><a href="https://github.com/pcsforeducation/diveintopython/issues?sort=created&state=open">Report issues<img style="margin-left:10px" height="40" src="../images/logo_github.png"></a></p>
    <p class="copyright">Copyright &copy; 2000, 2001, 2002, 2003, 2004 <a href="mailto:josh@servercobra.com">Mark Pilgrim</a>. Maintained by Josh Gachnang.</p>
</div>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-1879314568120827";
/* DiveIntoPython */
google_ad_slot = "8002881514";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<!-- End Footer -->
            </div>
        </div>
        <!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9740779-18']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End Google Analytics -->
        <script src="../js/jquery.js"></script>
        <script src="../js/foundation.min.js"></script>
        <script>
          $(document).foundation();
        </script>
    </body>
</html>