
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>3.6. Special class methods</title><link rel="stylesheet" href="http://web.archive.org/web/20110709015617cs_/http://ru.diveintopython.org/diveintopython.css" type="text/css"><link rev="made" href="mailto:f8dy@diveintopython.org"><meta name="generator" content="DocBook XSL Stylesheets V"><meta name="keywords" content="Python, &#1103;&#1079;&#1099;&#1082; Python, &#1103;&#1079;&#1099;&#1082; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; Python, Dive Into Python, &#1042; &#1075;&#1083;&#1091;&#1073;&#1100; &#1103;&#1079;&#1099;&#1082;&#1072; Python, &#1091;&#1095;&#1077;&#1073;&#1085;&#1080;&#1082;, &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081;, &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;, &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103;, &#1082;&#1085;&#1080;&#1075;&#1072;, free, &#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1085;&#1099;&#1081;, &#1073;&#1077;&#1089;&#1087;&#1083;&#1072;&#1090;&#1085;&#1099;&#1081;"><meta name="description" content="a free Python book for experienced programmers"><link rel="home" href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/toc.html" title="&#1042; &#1075;&#1083;&#1091;&#1073;&#1100; &#1103;&#1079;&#1099;&#1082;&#1072; Python"><link rel="up" href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_divein.html" title="&#1043;&#1083;&#1072;&#1074;&#1072; 3. &#1057;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;"><link rel="previous" href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_userdict.html" title="3.5. UserDict: a wrapper class"><link rel="next" href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_morespecial.html" title="3.7. Advanced special class methods"></head><body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="http://staticweb.archive.org/js/disclaim-element.js" ></script>
<script type="text/javascript" src="http://staticweb.archive.org/js/graph-calc.js" ></script>
<script type="text/javascript" src="http://staticweb.archive.org/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1325375999999;
var wbPrefix = "http://web.archive.org/web/";
var wbCurrentUrl = "http:\/\/ru.diveintopython.org\/fileinfo_specialmethods.html";

var curYear = -1;
var curMonth = -1;
var yearCount = 16;
var firstYear = 1996;
var imgWidth=400;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "9";
var displayMonth = "Jul";
var displayYear = "2011";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(http://staticweb.archive.org/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="http://wayback.archive.org/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="http://staticweb.archive.org/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="http://wayback.archive.org/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://ru.diveintopython.org/fileinfo_specialmethods.html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20110709015617" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="http://web.archive.org/web/20100929082751/http://ru.diveintopython.org/fileinfo_specialmethods.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="29 Sep 2010"><strong>SEP</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 1:56:17 Jul 9, 2011">JUL</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Aug
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="http://web.archive.org/web/20100929082751/http://ru.diveintopython.org/fileinfo_specialmethods.html" title="8:27:51 Sep 29, 2010" style="background-color:transparent;border:none;"><img src="http://staticweb.archive.org/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 1:56:17 Jul 9, 2011">9</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="http://staticweb.archive.org/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="http://web.archive.org/web/20100131022529/http://ru.diveintopython.org/fileinfo_specialmethods.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="31 Jan 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 1:56:17 Jul 9, 2011">2011</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2012
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="http://wayback.archive.org/web/20110709015617*/http://ru.diveintopython.org/fileinfo_specialmethods.html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>28 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">13 Sep 04 - 9 Jul 11</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:400px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:400px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="400"
				height="27"
				border="0"
				src="http://wayback.archive.org/jsp/graph.jsp?graphdata=400_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000001000_2005:-1:100000000001_2006:-1:000000100104_2007:-1:610000010100_2008:-1:101011100000_2009:-1:101000000000_2010:-1:100000001000_2011:6:000000100000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="http://staticweb.archive.org/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="http://staticweb.archive.org/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(http://staticweb.archive.org/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(http://staticweb.archive.org/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
<table id="Header" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td id="breadcrumb" colspan="5" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/index.html">&#1053;&#1072;&#1095;&#1072;&#1083;&#1086;</a>&nbsp;&gt;&nbsp;<a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/toc.html">&#1042; &#1075;&#1083;&#1091;&#1073;&#1100; &#1103;&#1079;&#1099;&#1082;&#1072; Python</a>&nbsp;&gt;&nbsp;<a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_divein.html">&#1057;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;</a>&nbsp;&gt;&nbsp;<b>Special class methods</b></td><td id="navigation" align="right">&nbsp;&nbsp;&nbsp;<a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_userdict.html" title="&#1055;&#1088;&#1077;&#1076;.: &#8220;UserDict: a wrapper class&#8221;">&lt;&lt;</a>&nbsp;&nbsp;&nbsp;<a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_morespecial.html" title="&#1057;&#1083;&#1077;&#1076;.: &#8220;Advanced special class methods&#8221;">&gt;&gt;</a></td></tr><tr><td><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/logo.png" alt="diveinto.python.ru"></td><td colspan="2"><span id="logo">&#1042; &#1075;&#1083;&#1091;&#1073;&#1100; &#1103;&#1079;&#1099;&#1082;&#1072; Python</span><br><span id="tagline">&#1044;&#1083;&#1103; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1089;&#1090;&#1086;&#1074;</span></td><td colspan="3" align="right"></td></tr></table><div class="section"><a name="fileinfo.specialmethods"></a><div class="titlepage"><div><h2 class="title"><a name="fileinfo.specialmethods"></a>3.6. Special class methods</h2></div></div><div class="abstract"><p>In addition to normal class methods, there are a number of special methods which Python classes can define.  Instead of being called directly by your code (like normal methods), special methods are called for you by Python in particular circumstances or when specific syntax is used.</p></div><p>As you saw in the <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_userdict.html" title="3.5. UserDict: a wrapper class">previous section</a>, normal methods went a long way towards wrapping a dictionary in a class.  But normal methods alone are not enough, because there are lots of things you can do with dictionaries besides call methods on them.  For starters, you can <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/odbchelper_dict.html#odbchelper.dict.define" title="&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 1.9. &#1054;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080; &#1089;&#1083;&#1086;&#1074;&#1072;&#1088;&#1077;&#1081;">get</a> and <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/odbchelper_dict.html#odbchelper.dict.modify" title="&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 1.10. &#1048;&#1079;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1077; &#1089;&#1083;&#1086;&#1074;&#1072;&#1088;&#1077;&#1081;">set</a> items with a syntax that doesn't include explicitly invoking methods.  This is where special class methods come in: they provide a way to map non-method-calling syntax into method calls.</p><div class="example"><p><a name="d0e3600"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.13. The <tt>__getitem__</tt> special method</b></p><pre class="programlisting">
    <span class='pykeyword'>def</span><span class='pyclass'> __getitem__</span>(self, key): <span class='pykeyword'>return</span> self.data[key]</pre><pre class="screen"><tt>&gt;&gt;&gt; </tt><span class="userinput">f = fileinfo.FileInfo(<span class='pystring'>"/music/_singles/kairo.mp3"</span>)</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">f</span>
<span class="computeroutput">{'name':'/music/_singles/kairo.mp3'}</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">f.__getitem__(<span class='pystring'>"name"</span>)</span> <a name="fileinfo.specialmethods.1.1"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12">
<span class="computeroutput">'/music/_singles/kairo.mp3'</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">f[<span class='pystring'>"name"</span>]</span>             <a name="fileinfo.specialmethods.1.2"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12">
<span class="computeroutput">'/music/_singles/kairo.mp3'</span></pre><div class="calloutlist"><a name="d0e3618"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.1.1"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12"></a> </td><td valign="top" align="left">The <tt>__getitem__</tt> special method looks simple enough.  Like the normal methods <tt>clear</tt>, <tt>keys</tt>, and <tt>values</tt>, it just redirects to the dictionary to return its value.  But how does it get called?  Well, you can call <tt>__getitem__</tt> directly, but in practice you wouldn't actually do that; I'm just doing it here to show you how it works.  The right way to use <tt>__getitem__</tt> is to get Python to call it for you.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.1.2"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12"></a> </td><td valign="top" align="left">This looks just like the syntax you would use to <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/odbchelper_dict.html#odbchelper.dict.define" title="&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 1.9. &#1054;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080; &#1089;&#1083;&#1086;&#1074;&#1072;&#1088;&#1077;&#1081;">get a dictionary value</a>, and in fact it returns the value you would expect.  But here's the missing link: under the covers, Python has converted this syntax to the method call <tt>f.__getitem__("name")</tt>.  That's why <tt>__getitem__</tt> is a special class method; not only can you call it yourself, you can get Python to call it for you by using the right syntax.</td></tr></table></div></div><div class="example"><p><a name="fileinfo.specialmethods.setitem.example"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.14. The <tt>__setitem__</tt> special method</b></p><pre class="programlisting">
    <span class='pykeyword'>def</span><span class='pyclass'> __setitem__</span>(self, key, item): self.data[key] = item</pre><pre class="screen"><tt>&gt;&gt;&gt; </tt><span class="userinput">f</span>
<span class="computeroutput">{'name':'/music/_singles/kairo.mp3'}</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">f.__setitem__(<span class='pystring'>"genre"</span>, 31)</span> <a name="fileinfo.specialmethods.2.1"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12">
<tt>&gt;&gt;&gt; </tt><span class="userinput">f</span>
<span class="computeroutput">{'name':'/music/_singles/kairo.mp3', 'genre':31}</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">f[<span class='pystring'>"genre"</span>] = 32</span>            <a name="fileinfo.specialmethods.2.2"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12">
<tt>&gt;&gt;&gt; </tt><span class="userinput">f</span>
<span class="computeroutput">{'name':'/music/_singles/kairo.mp3', 'genre':32}</span></pre><div class="calloutlist"><a name="d0e3655"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.2.1"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12"></a> </td><td valign="top" align="left">Like the <tt>__getitem__</tt> method, <tt>__setitem__</tt> simply redirects to the real dictionary <tt>self.data</tt> to do its work.  And like <tt>__getitem__</tt>, you wouldn't ordinarily call it directly like this; Python calls <tt>__setitem__</tt> for you when you use the right syntax.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.2.2"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12"></a> </td><td valign="top" align="left">This looks like regular dictionary syntax, except of course that <tt>f</tt> is really a class that's trying very hard to masquerade as a dictionary, and <tt>__setitem__</tt> is an essential part of that masquerade.  This line of code actually calls <tt>f.__setitem__("genre", 32)</tt> under the covers.</td></tr></table></div></div><p><tt>__setitem__</tt> is a special class method because it gets called for you, but it's still a class method.  Just as easily as the <tt>__setitem__</tt> method was defined in <tt>UserDict</tt>, we can redefine it in our descendant class to override the ancestor method.  This allows us to define classes that act like dictionaries in some ways but define their own behavior above and beyond the built-in dictionary.</p><p>This concept is the basis of the entire framework we're studying in this chapter.  Each file type can have a handler class which knows how to get metadata from a particular type of file.  Once some attributes (like the file's name and location) are known, the handler class knows how to derive other attributes automatically.  This is done by overriding the <tt>__setitem__</tt> method, checking for particular keys, and adding additional processing when they are found.</p><p>For example, <tt>MP3FileInfo</tt> is a descendant of <tt>FileInfo</tt>.  When an <tt>MP3FileInfo</tt>'s <tt>name</tt> is set, it doesn't just set the <tt>name</tt> key (like the ancestor <tt>FileInfo</tt> does); it also looks in the file itself for MP3 tags and populates a whole set of keys.</p><div class="example"><p><a name="d0e3683"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.15. Overriding <tt>__setitem__</tt> in <tt>MP3FileInfo</tt></b></p><pre class="programlisting">
    <span class='pykeyword'>def</span><span class='pyclass'> __setitem__</span>(self, key, item):         <a name="fileinfo.specialmethods.3.1"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12">
        <span class='pykeyword'>if</span> key == <span class='pystring'>"name"</span> <span class='pykeyword'>and</span> item:            <a name="fileinfo.specialmethods.3.2"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12">
            self.__parse(item)                <a name="fileinfo.specialmethods.3.3"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/3.png" alt="3" border="0" width="12" height="12">
        FileInfo.__setitem__(self, key, item) <a name="fileinfo.specialmethods.3.4"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/4.png" alt="4" border="0" width="12" height="12"></pre><div class="calloutlist"><a name="d0e3692"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.3.1"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12"></a> </td><td valign="top" align="left">Note that our <tt>__setitem__</tt> method is defined exactly the same way as the ancestor method.  This is important, since Python will be calling the method for us, and it expects it to be defined with a certain number of arguments.  (Technically speaking, the names of the arguments don't matter, just the number.)</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.3.2"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12"></a> </td><td valign="top" align="left">Here's the crux of the entire <tt>MP3FileInfo</tt> class: if we're assigning a value to the <tt>name</tt> key, we want to do something extra.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.3.3"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/3.png" alt="3" border="0" width="12" height="12"></a> </td><td valign="top" align="left">The extra processing we do for <tt>name</tt>s is encapsulated in the <tt>__parse</tt> method.  This is another class method defined in <tt>MP3FileInfo</tt>, and when we call it, we qualify it with <tt>self</tt>.  Just calling <tt>__parse</tt> would look for a normal function defined outside the class, which is not what we want; calling <tt>self.__parse</tt> will look for a class method defined within the class.  This isn't anything new; you reference <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_userdict.html#fileinfo.userdict.normalmethods" title="&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.12. UserDict normal methods">data attributes</a> the same way.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.3.4"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/4.png" alt="4" border="0" width="12" height="12"></a> </td><td valign="top" align="left">After doing our extra processing, we want to call the ancestor method.  Remember, this is never done for you in Python; you have to do it manually.  Note that we're calling the immediate ancestor, <tt>FileInfo</tt>, even though it doesn't have a <tt>__setitem__</tt> method.  That's okay, because Python will walk up the ancestor tree until it finds a class with the method we're calling, so this line of code will eventually find and call the <tt>__setitem__</tt> defined in <tt>UserDict</tt>.</td></tr></table></div></div><a name="tip.self.call"></a><table class="note" border="0"><tr><td rowspan="2" align="center" valign="top" width="24"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/note.png" alt="&#1047;&#1072;&#1084;&#1077;&#1095;&#1072;&#1085;&#1080;&#1077;" width="24" height="24"></td></tr><tr><td colspan="2" align="left" valign="top">When accessing data attributes within a class, you need to qualify the attribute name: <tt>self.<i>attribute</i></tt>.  When calling other methods within a class, you need to qualify the method name: <tt>self.<i>method</i></tt>.</td></tr></table><div class="example"><p><a name="fileinfo.specialmethods.setname"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.16. Setting an <tt>MP3FileInfo</tt>'s <tt>name</tt></b></p><pre class="screen"><tt>&gt;&gt;&gt; </tt><span class="userinput"><span class='pykeyword'>import</span> fileinfo</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">mp3file = fileinfo.MP3FileInfo()</span>                   <a name="fileinfo.specialmethods.4.1"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12">
<tt>&gt;&gt;&gt; </tt><span class="userinput">mp3file</span>
<span class="computeroutput">{'name':None}</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">mp3file[<span class='pystring'>"name"</span>] = <span class='pystring'>"/music/_singles/kairo.mp3"</span></span>      <a name="fileinfo.specialmethods.4.2"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12">
<tt>&gt;&gt;&gt; </tt><span class="userinput">mp3file</span>
<span class="computeroutput">{'album': 'Rave Mix', 'artist': '***DJ MARY-JANE***', 'genre': 31,
'title': 'KAIRO****THE BEST GOA', 'name': '/music/_singles/kairo.mp3',
'year': '2000', 'comment': 'http://mp3.com/DJMARYJANE'}</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">mp3file[<span class='pystring'>"name"</span>] = <span class='pystring'>"/music/_singles/sidewinder.mp3"</span></span> <a name="fileinfo.specialmethods.4.3"></a><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/3.png" alt="3" border="0" width="12" height="12">
<tt>&gt;&gt;&gt; </tt><span class="userinput">mp3file</span>
<span class="computeroutput">{'album': '', 'artist': 'The Cynic Project', 'genre': 18, 'title': 'Sidewinder', 
'name': '/music/_singles/sidewinder.mp3', 'year': '2000', 
'comment': 'http://mp3.com/cynicproject'}</span></pre><div class="calloutlist"><a name="d0e3750"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.4.1"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/1.png" alt="1" border="0" width="12" height="12"></a> </td><td valign="top" align="left">First, we create an instance of <tt>MP3FileInfo</tt>, without passing it a filename.  (We can get away with this because the <tt>filename</tt> argument of the <tt>__init__</tt> method is <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/apihelper_optional.html" title="2.2. &#1053;&#1077;&#1086;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1077; &#1080; &#1080;&#1084;&#1077;&#1085;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077; &#1072;&#1088;&#1075;&#1091;&#1084;&#1077;&#1085;&#1090;&#1099;">optional</a>.)  Since <tt>MP3FileInfo</tt> has no <tt>__init__</tt> method of its own, Python walks up the ancestor tree and finds the <tt>__init__</tt> method of <tt>FileInfo</tt>.  This <tt>__init__</tt> method manually calls the <tt>__init__</tt> method of <tt>UserDict</tt> and then sets the <tt>name</tt> key to <tt>filename</tt>, which is <tt>None</tt>, since we didn't pass a filename.  Thus, <tt>mp3file</tt> initially looks like a dictionary with one key, <tt>name</tt>, whose value is <tt>None</tt>.
</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.4.2"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/2.png" alt="2" border="0" width="12" height="12"></a> </td><td valign="top" align="left">Now the real fun begins.  Setting the <tt>name</tt> key of <tt>mp3file</tt> triggers the <tt>__setitem__</tt> method on <tt>MP3FileInfo</tt> (not <tt>UserDict</tt>), which notices that we're setting the <tt>name</tt> key with a real value and calls <tt>self.__parse</tt>.  Although we haven't traced through the <tt>__parse</tt> method yet, you can see from the output that it sets several other keys: <tt>album</tt>, <tt>artist</tt>, <tt>genre</tt>, <tt>title</tt>, <tt>year</tt>, and <tt>comment</tt>.
</td></tr><tr><td width="12" valign="top" align="left"><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_specialmethods.html#fileinfo.specialmethods.4.3"><img src="http://web.archive.org/web/20110709015617im_/http://ru.diveintopython.org/images/callouts/3.png" alt="3" border="0" width="12" height="12"></a> </td><td valign="top" align="left">Modifying the <tt>name</tt> key will go through the same process again: Python calls <tt>__setitem__</tt>, which calls <tt>self.__parse</tt>, which sets all the other keys.
</td></tr></table></div></div></div><table class="Footer" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td width="35%" align="left"><br><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_userdict.html"><span class="NavigationArrow">&lt;&lt;</span>&nbsp;UserDict: a wrapper class</a></td><td width="30%" align="center"><br>&nbsp;<a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_divein.html#fileinfo.divein" title="3.1. &#1042; &#1075;&#1083;&#1091;&#1073;&#1100;">1</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_fromimport.html" title="3.2. &#1048;&#1084;&#1087;&#1086;&#1088;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1084;&#1086;&#1076;&#1091;&#1083;&#1077;&#1081; &#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1094;&#1080;&#1077;&#1081; from module import">2</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_class.html" title="3.3. &#1054;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1074;">3</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_instantiation.html" title="3.4. &#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1101;&#1082;&#1079;&#1077;&#1084;&#1087;&#1083;&#1103;&#1088;&#1086;&#1074; &#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1074;">4</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_userdict.html" title="3.5. UserDict: a wrapper class">5</a> <b>6</b> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_morespecial.html" title="3.7. Advanced special class methods">7</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_classattributes.html" title="3.8. Class attributes">8</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_private.html" title="3.9. Private functions">9</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_exception.html" title="3.10. Handling exceptions">10</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_files.html" title="3.11. File objects">11</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_for.html" title="3.12. for loops">12</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_modules.html" title="3.13. More on modules">13</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_os.html" title="3.14. The os module">14</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_alltogether.html" title="3.15. Putting it all together">15</a> <a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_summary.html" title="3.16. Summary">16</a>&nbsp;</td><td width="35%" align="right"><br><a href="http://web.archive.org/web/20110709015617/http://ru.diveintopython.org/fileinfo_morespecial.html">Advanced special class methods&nbsp;<span class="NavigationArrow">&gt;&gt;</span></a></td></tr><tr><td colspan="3"><br></td></tr></table><table class="Footer" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td align="left"><p class="copyright">Copyright &copy; 2000, 2001, 2002 <a href="mailto:f8dy@diveintopython.org">&#1052;&#1072;&#1088;&#1082; &#1055;&#1080;&#1083;&#1075;&#1088;&#1080;&#1084;</a></p><p class="copyright">Copyright &copy; 2001, 2002, 2003 &#1055;&#1077;&#1088;&#1077;&#1074;&#1086;&#1076;, <a href="mailto:ods@strana.ru">&#1044;&#1077;&#1085;&#1080;&#1089; &#1054;&#1090;&#1082;&#1080;&#1076;&#1072;&#1095;</a></p></td><td align="left">&nbsp;</td></tr></table></body></html>





<!--
     FILE ARCHIVED ON 1:56:17 Jul 9, 2011 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 19:32:37 Nov 4, 2011.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
