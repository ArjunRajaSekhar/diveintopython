
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>3.12. for loops</title><link rel="stylesheet" href="/css/diveintopython.css" type="text/css" /><link rev="made" href="josh@servercobra.com" /><meta name="generator" content="DocBook XSL Stylesheets V" /><meta name="keywords" content="Python, язык Python, язык программирования Python, Dive Into Python, В глубь языка Python, учебник, объектно-ориентированный, программирование, документация, книга, free, свободный, бесплатный" /><meta name="description" content="a free Python book for experienced programmers" /><link rel="home" href="http://ru.diveintopython.net/" title="В глубь языка Python" /><link rel="up" href="http://ru.diveintopython.net/" title="Глава 3. Средства объектно-ориентированного программирования" /><link rel="previous" href="http://ru.diveintopython.net/" title="3.11. File objects" /><link rel="next" href="http://ru.diveintopython.net/" title="3.13. More on modules" /><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9740779-18']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></head><body>
<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<table id="Header" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td id="breadcrumb" colspan="5" align="left"><a href="http://ru.diveintopython.net/index.html">&#1053;&#1072;&#1095;&#1072;&#1083;&#1086;</a>&nbsp;&gt;&nbsp;<a href="http://ru.diveintopython.net/toc.html">&#1042; &#1075;&#1083;&#1091;&#1073;&#1100; &#1103;&#1079;&#1099;&#1082;&#1072; Python</a>&nbsp;&gt;&nbsp;<a href="http://ru.diveintopython.net/fileinfo_divein.html">&#1057;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;</a>&nbsp;&gt;&nbsp;<b>for loops</b></td><td id="navigation" align="right">&nbsp;&nbsp;&nbsp;<a href="http://ru.diveintopython.net/fileinfo_files.html" title="Пред.: “File objects”">&lt;&lt;</a>&nbsp;&nbsp;&nbsp;<a href="http://ru.diveintopython.net/fileinfo_modules.html" title="След.: “More on modules”">&gt;&gt;</a></td></tr><tr><td><img src="http://ru.diveintopython.net/images/logo.png" alt="diveinto.python.ru" /></td><td colspan="2"><span id="logo">&#1042; &#1075;&#1083;&#1091;&#1073;&#1100; &#1103;&#1079;&#1099;&#1082;&#1072; Python</span><br /><span id="tagline">&#1044;&#1083;&#1103; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1089;&#1090;&#1086;&#1074;</span></td><td colspan="3" align="right"></td></tr></table><div class="section"><a name="fileinfo.for"></a><div class="titlepage"><div><h2 class="title"><a name="fileinfo.for"></a>3.12. <tt>for</tt> loops</h2></div></div><div class="abstract"><p>Like most other languages, Python has <tt>for</tt> loops.  The only reason you haven't seen them until now is that Python is good at so many other things that you don't need them as often.</p></div><p>Most other languages don't have a powerful list datatype like Python, so you end up doing a lot of manual work, specifying a start, end, and step to define a range of integers or characters or other iteratable entities.  But in Python, a <tt>for</tt> loop simply iterates over a list, the same way <a href="http://ru.diveintopython.net/odbchelper_map.html" title="1.13. Обработка списков">list comprehensions</a> work.</p><div class="example"><p><a name="d0e4524"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.27. Introducing the <tt>for</tt> loop</b></p><pre class="screen"><tt>&gt;&gt;&gt; </tt><span class="userinput">li = [<span class="pystring">'a'</span>, <span class="pystring">'b'</span>, <span class="pystring">'e'</span>]</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">for</span> s <span class="pykeyword">in</span> li:</span>         <a name="fileinfo.for.1.1"></a><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" />
<tt>...     </tt><span class="userinput"><span class="pykeyword">print</span> s</span>          <a name="fileinfo.for.1.2"></a><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" />
<span class="computeroutput">a
b
e</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">print</span> <span class="pystring">"\n"</span>.join(li)</span>  <a name="fileinfo.for.1.3"></a><img src="http://ru.diveintopython.net/images/callouts/3.png" alt="3" border="0" width="12" height="12" />
<span class="computeroutput">a
b
e</span></pre><div class="calloutlist"><a name="d0e4541"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.1.1"><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">The syntax for a <tt>for</tt> loop is similar to <a href="http://ru.diveintopython.net/odbchelper_map.html" title="1.13. Обработка списков">list comprehensions</a>.  <tt>li</tt> is a list, and <tt>s</tt> will take the value of each element in turn, starting from the first element.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.1.2"><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">Like an <tt>if</tt> statement or any other <a href="http://ru.diveintopython.net/odbchelper_indenting.html" title="1.5. Отступы">indented block</a>, a <tt>for</tt> loop can have any number of lines of code in it.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.1.3"><img src="http://ru.diveintopython.net/images/callouts/3.png" alt="3" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">This is the reason you haven't seen the <tt>for</tt> loop yet: we haven't needed it yet.  It's amazing how often you use <tt>for</tt> loops in other languages when all you really want is a <tt>join</tt> or a list comprehension.</td></tr></table></div></div><div class="example"><p><a name="fileinfo.for.counter"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.28. Simple counters</b></p><pre class="screen">
<tt>&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">for</span> i <span class="pykeyword">in</span> range(5):</span>       <a name="fileinfo.for.3.1"></a><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" />
<tt>...     </tt><span class="userinput"><span class="pykeyword">print</span> i</span>
<span class="computeroutput">0
1
2
3
4</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput">li = [<span class="pystring">'a'</span>, <span class="pystring">'b'</span>, <span class="pystring">'c'</span>, <span class="pystring">'d'</span>, <span class="pystring">'e'</span>]</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">for</span> i <span class="pykeyword">in</span> range(len(li)):</span> <a name="fileinfo.for.3.2"></a><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" />
<tt>...     </tt><span class="userinput"><span class="pykeyword">print</span> li[i]</span>
<span class="computeroutput">a
b
c
d
e</span>
</pre><div class="calloutlist"><a name="d0e4575"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.3.1"><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">Doing a &#8220;normal&#8221; (by Visual Basic standards) counter <tt>for</tt> loop is also simple.  As we saw in <a href="http://ru.diveintopython.net/odbchelper_multiassign.html#odbchelper.multiassign.range" title="Пример 1.27. Присваивание идущих подряд значений">&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 1.27. &#1055;&#1088;&#1080;&#1089;&#1074;&#1072;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077; &#1080;&#1076;&#1091;&#1097;&#1080;&#1093; &#1087;&#1086;&#1076;&#1088;&#1103;&#1076; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1081;</a>, <tt>range</tt> produces a list of integers, which we then loop through.  I know it looks a bit odd, but it is occasionally (and I stress <span class="emphasis"><i>occasionally</i></span>) useful to have a counter loop.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.3.2"><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">Don't ever do this.  This is Visual Basic-style thinking.  Break out of it.  Just iterate through the list, as shown in the previous example.</td></tr></table></div></div><div class="example"><p><a name="dictionaryiter.example"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.29. Iterating through a dictionary</b></p><pre class="screen"><tt>&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">for</span> k, v <span class="pykeyword">in</span> os.environ.items():</span> <a name="fileinfo.for.2.1"></a><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" /> <a name="fileinfo.for.2.2"></a><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" />
<tt>...     </tt><span class="userinput"><span class="pykeyword">print</span> <span class="pystring">"%s=%s"</span> % (k, v)</span>
<span class="computeroutput">USERPROFILE=C:\Documents and Settings\mpilgrim
OS=Windows_NT
COMPUTERNAME=MPILGRIM
USERNAME=mpilgrim

[...snip...]</span>
<tt>&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">print</span> <span class="pystring">"\n"</span>.join([<span class="pystring">"%s=%s"</span> % (k, v) <span class="pykeyword">for</span> k, v <span class="pykeyword">in</span> os.environ.items()])</span> <a name="fileinfo.for.2.3"></a><img src="http://ru.diveintopython.net/images/callouts/3.png" alt="3" border="0" width="12" height="12" />
<span class="computeroutput">USERPROFILE=C:\Documents and Settings\mpilgrim
OS=Windows_NT
COMPUTERNAME=MPILGRIM
USERNAME=mpilgrim

[...snip...]</span></pre><div class="calloutlist"><a name="d0e4601"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.2.1"><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" /></a> </td><td valign="top" align="left"><tt>os.environ</tt> is a dictionary of the environment variables defined on your system.  In Windows, these are your user and system variables accessible from MS-DOS.  In UNIX, they are the variables exported in your shell's startup scripts.  In Mac OS, there is no concept of environment variables, so this dictionary is empty.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.2.2"><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" /></a> </td><td valign="top" align="left"><tt>os.environ.items()</tt> returns a list of tuples: <tt>[(<i>key1</i>, <i>value1</i>), (<i>key2</i>, <i>value2</i>), ...]</tt>.  The <tt>for</tt> loop iterates through this list.  The first round, it assigns <tt><i>key1</i></tt> to <tt>k</tt> and <tt><i>value1</i></tt> to <tt>v</tt>, so <tt>k</tt> = <tt>USERPROFILE</tt> and <tt>v</tt> = <tt>C:\Documents and Settings\mpilgrim</tt>.  The second round, <tt>k</tt> gets the second key, <tt>OS</tt>, and <tt>v</tt> gets the corresponding value, <tt>Windows_NT</tt>.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.for.2.3"><img src="http://ru.diveintopython.net/images/callouts/3.png" alt="3" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">With <a href="http://ru.diveintopython.net/odbchelper_multiassign.html" title="1.11. Присваивание сразу нескольких значений">multi-variable assignment</a> and <a href="http://ru.diveintopython.net/odbchelper_map.html" title="1.13. Обработка списков">list comprehensions</a>, you can replace the entire <tt>for</tt> loop with a single statement.  Whether you actually do this in real code is a matter of personal coding style; I like it because it makes it clear that what we're doing is mapping a dictionary into a list, then joining the list into a single string.  Other programmers prefer to write this out as a <tt>for</tt> loop.  Note that the output is the same in either case, although this version is slightly faster, because there is only one <tt>print</tt> statement instead of many.</td></tr></table></div></div><div class="example"><p><a name="fileinfo.multiassign.for.example"></a><b>&#1055;&#1088;&#1080;&#1084;&#1077;&#1088; 3.30. <tt>for</tt> loop in <tt>MP3FileInfo</tt></b></p><pre class="programlisting">
    tagDataMap = {<span class="pystring">"title"</span>   : (  3,  33, stripnulls),
                  <span class="pystring">"artist"</span>  : ( 33,  63, stripnulls),
                  <span class="pystring">"album"</span>   : ( 63,  93, stripnulls),
                  <span class="pystring">"year"</span>    : ( 93,  97, stripnulls),
                  <span class="pystring">"comment"</span> : ( 97, 126, stripnulls),
                  <span class="pystring">"genre"</span>   : (127, 128, ord)} <a name="fileinfo.multiassign.5.1"></a><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" />
    .
    .
    .
            <span class="pykeyword">if</span> tagdata[:3] == <span class="pystring">"TAG"</span>:
                <span class="pykeyword">for</span> tag, (start, end, parseFunc) <span class="pykeyword">in</span> self.tagDataMap.items(): <a name="fileinfo.multiassign.5.2"></a><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" />
                    self[tag] = parseFunc(tagdata[start:end])                <a name="fileinfo.multiassign.5.3"></a><img src="http://ru.diveintopython.net/images/callouts/3.png" alt="3" border="0" width="12" height="12" /></pre><div class="calloutlist"><a name="d0e4647"></a><table border="0" summary="Callout list"><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.multiassign.5.1"><img src="http://ru.diveintopython.net/images/callouts/1.png" alt="1" border="0" width="12" height="12" /></a> </td><td valign="top" align="left"><tt>tagDataMap</tt> is a <a href="http://ru.diveintopython.net/fileinfo_classattributes.html" title="3.8. Class attributes">class attribute</a> that defines the tags we're looking for in an MP3 file.  Tags are stored in fixed-length fields; once we read the last 128 bytes of the file, bytes 3 through 32 of those are always the song title, 33-62 are always the artist name, 63-92 the album name, and so forth.  Note that <tt>tagDataMap</tt> is a dictionary of tuples, and each tuple contains two integers and a function reference.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.multiassign.5.2"><img src="http://ru.diveintopython.net/images/callouts/2.png" alt="2" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">This looks complicated, but it's not.  The structure of the <tt>for</tt> variables matches the structure of the elements of the list returned by <tt>items</tt>.  Remember, <tt>items</tt> returns a list of tuples of the form <tt>(<i>key</i>, <i>value</i>)</tt>.  The first element of that list is <tt>("title", (3, 33, &lt;function stripnulls&gt;))</tt>, so the first time around the loop, <tt>tag</tt> gets <tt>"title"</tt>, <tt>start</tt> gets <tt>3</tt>, <tt>end</tt> gets <tt>33</tt>, and <tt>parseFunc</tt> gets the function <tt>stripnulls</tt>.</td></tr><tr><td width="12" valign="top" align="left"><a href="http://ru.diveintopython.net/fileinfo_for.html#fileinfo.multiassign.5.3"><img src="http://ru.diveintopython.net/images/callouts/3.png" alt="3" border="0" width="12" height="12" /></a> </td><td valign="top" align="left">Now that we've extracted all the parameters for a single MP3 tag, saving the tag data is easy.  We <a href="http://ru.diveintopython.net/odbchelper_list.html#odbchelper.list.slice" title="Пример 1.16. Срез">slice</a> <tt>tagdata</tt> from <tt>start</tt> to <tt>end</tt> to get the actual data for this tag, call <tt>parseFunc</tt> to post-process the data, and assign this as the value for the key <tt>tag</tt> in the pseudo-dictionary <tt>self</tt>.  After iterating through all the elements in <tt>tagDataMap</tt>, <tt>self</tt> has the values for all the tags, and <a href="http://ru.diveintopython.net/fileinfo_specialmethods.html#fileinfo.specialmethods.setname" title="Пример 3.16. Setting an MP3FileInfo's name">you know what that looks like</a>.</td></tr></table></div></div></div><table class="Footer" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td width="35%" align="left"><br /><a href="http://ru.diveintopython.net/fileinfo_files.html"><span class="NavigationArrow">&lt;&lt;</span>&nbsp;File objects</a></td><td width="30%" align="center"><br />&nbsp;<a href="http://ru.diveintopython.net/fileinfo_divein.html#fileinfo.divein" title="3.1. В глубь">1</a> <a href="http://ru.diveintopython.net/fileinfo_fromimport.html" title="3.2. Импортирование модулей инструкцией from module import">2</a> <a href="http://ru.diveintopython.net/fileinfo_class.html" title="3.3. Определение классов">3</a> <a href="http://ru.diveintopython.net/fileinfo_instantiation.html" title="3.4. Создание экземпляров классов">4</a> <a href="http://ru.diveintopython.net/fileinfo_userdict.html" title="3.5. UserDict: a wrapper class">5</a> <a href="http://ru.diveintopython.net/fileinfo_specialmethods.html" title="3.6. Special class methods">6</a> <a href="http://ru.diveintopython.net/fileinfo_morespecial.html" title="3.7. Advanced special class methods">7</a> <a href="http://ru.diveintopython.net/fileinfo_classattributes.html" title="3.8. Class attributes">8</a> <a href="http://ru.diveintopython.net/fileinfo_private.html" title="3.9. Private functions">9</a> <a href="http://ru.diveintopython.net/fileinfo_exception.html" title="3.10. Handling exceptions">10</a> <a href="http://ru.diveintopython.net/fileinfo_files.html" title="3.11. File objects">11</a> <b>12</b> <a href="http://ru.diveintopython.net/fileinfo_modules.html" title="3.13. More on modules">13</a> <a href="http://ru.diveintopython.net/fileinfo_os.html" title="3.14. The os module">14</a> <a href="http://ru.diveintopython.net/fileinfo_alltogether.html" title="3.15. Putting it all together">15</a> <a href="http://ru.diveintopython.net/fileinfo_summary.html" title="3.16. Summary">16</a>&nbsp;</td><td width="35%" align="right"><br /><a href="http://ru.diveintopython.net/fileinfo_modules.html">More on modules&nbsp;<span class="NavigationArrow">&gt;&gt;</span></a></td></tr><tr><td colspan="3"><br /></td></tr></table><table class="Footer" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td align="left"><p class="copyright">Copyright &copy; 2000, 2001, 2002 <a href="mailto:josh@servercobra.com">&#1052;&#1072;&#1088;&#1082; &#1055;&#1080;&#1083;&#1075;&#1088;&#1080;&#1084;</a></p><p class="copyright">Copyright &copy; 2001, 2002, 2003 &#1055;&#1077;&#1088;&#1077;&#1074;&#1086;&#1076;, <a href="mailto:josh@servercobra.com">&#1044;&#1077;&#1085;&#1080;&#1089; &#1054;&#1090;&#1082;&#1080;&#1076;&#1072;&#1095;</a></p></td><td align="left">&nbsp;</td></tr></table></body></html>
